From: Wolfram Quester <wolfi@sigxcpu.org>
Date: Sat, 16 Apr 2011 12:44:47 +0200
Subject: Rebranding

---
 backend/vcarddir.php          |    4 ++--
 backend/zarafa/zarafa.php     |    6 +++---
 index.php                     |    6 +++---
 lib/core/interprocessdata.php |    4 ++--
 lib/core/loopdetection.php    |    4 ++--
 lib/core/topcollector.php     |    4 ++--
 lib/core/zpush.php            |   10 +++++++---
 lib/utils/timezoneutil.php    |    4 ++--
 lib/wbxml/wbxmldecoder.php    |    4 ++--
 9 files changed, 25 insertions(+), 21 deletions(-)

diff --git a/backend/vcarddir.php b/backend/vcarddir.php
index b5f4e01..b36b1f3 100644
--- a/backend/vcarddir.php
+++ b/backend/vcarddir.php
@@ -524,7 +524,7 @@ class BackendVCardDir extends BackendDiff {
             'jobtitle' => 'ROLE',
             'webpage' => 'URL',
         );
-        $data = "BEGIN:VCARD\nVERSION:2.1\nPRODID:Z-Push\n";
+        $data = "BEGIN:VCARD\nVERSION:2.1\nPRODID:d-push\n";
         foreach($mapping as $k => $v){
             $val = '';
             $ks = explode(';', $k);
@@ -670,4 +670,4 @@ class BackendVCardDir extends BackendDiff {
         return $data;
     }
 };
-?>
\ No newline at end of file
+?>
diff --git a/backend/zarafa/zarafa.php b/backend/zarafa/zarafa.php
index 142e446..7596c53 100644
--- a/backend/zarafa/zarafa.php
+++ b/backend/zarafa/zarafa.php
@@ -1246,7 +1246,7 @@ class BackendZarafa implements IBackend, ISearchProvider {
                 array(
                     FUZZYLEVEL      => FL_PREFIX,
                     ULPROPTAG       => PR_DISPLAY_NAME,
-                    VALUE           => array(PR_DISPLAY_NAME=>"Z-Push Search Folder ".$pid)
+                    VALUE           => array(PR_DISPLAY_NAME=>"D-Push Search Folder ".$pid)
                 )
             ),
             TBL_BATCH);
@@ -1720,7 +1720,7 @@ class BackendZarafa implements IBackend, ISearchProvider {
      * @return mapiFolderObject
      */
     private function createSearchFolder($searchFolderRoot) {
-        $folderName = "Z-Push Search Folder ".@getmypid();
+        $folderName = "D-Push Search Folder ".@getmypid();
         $searchFolders = mapi_folder_gethierarchytable($searchFolderRoot);
         $restriction = array(
             RES_CONTENT,
@@ -2041,4 +2041,4 @@ class BackendZarafa implements IBackend, ISearchProvider {
  */
 class BackendICS extends BackendZarafa {}
 
-?>
\ No newline at end of file
+?>
diff --git a/index.php b/index.php
index 361698f..7076222 100644
--- a/index.php
+++ b/index.php
@@ -150,7 +150,7 @@ include_once('version.php');
 
         // Check required GET parameters
         if(Request::IsMethodPOST() && (Request::GetCommandCode() === false || !Request::GetGETUser() || !Request::GetDeviceID() || !Request::GetDeviceType()))
-            throw new FatalException("Requested the Z-Push URL without the required GET parameters");
+            throw new FatalException("Requested the d-push URL without the required GET parameters");
 
         // Load the backend
         $backend = ZPush::GetBackend();
@@ -173,7 +173,7 @@ include_once('version.php');
 
         // Do the actual processing of the request
         if (Request::IsMethodGET())
-            throw new NoPostRequestException("This is the Z-Push location and can only be accessed by Microsoft ActiveSync-capable devices", NoPostRequestException::GET_REQUEST);
+            throw new NoPostRequestException("This is the d-push location and can only be accessed by Microsoft ActiveSync-capable devices", NoPostRequestException::GET_REQUEST);
 
         // Do the actual request
         header(ZPush::GetServerHeader());
@@ -292,4 +292,4 @@ include_once('version.php');
 
     // end gracefully
     ZLog::Write(LOGLEVEL_DEBUG, '-------- End');
-?>
\ No newline at end of file
+?>
diff --git a/lib/core/interprocessdata.php b/lib/core/interprocessdata.php
index 5a5cefc..53c2839 100644
--- a/lib/core/interprocessdata.php
+++ b/lib/core/interprocessdata.php
@@ -92,7 +92,7 @@ abstract class InterProcessData {
     private function InitSharedMem() {
         // shared mem general "turn off switch"
         if (defined("USE_SHARED_MEM") && USE_SHARED_MEM === false) {
-            ZLog::Write(LOGLEVEL_INFO, "InterProcessData::InitSharedMem(): the usage of shared memory for Z-Push has been disabled. Check your config for 'USE_SHARED_MEM'.");
+            ZLog::Write(LOGLEVEL_INFO, "InterProcessData::InitSharedMem(): the usage of shared memory for D-Push has been disabled. Check your config for 'USE_SHARED_MEM'.");
             return false;
         }
 
@@ -294,4 +294,4 @@ abstract class InterProcessData {
 
 }
 
-?>
\ No newline at end of file
+?>
diff --git a/lib/core/loopdetection.php b/lib/core/loopdetection.php
index 225d853..4991594 100644
--- a/lib/core/loopdetection.php
+++ b/lib/core/loopdetection.php
@@ -272,7 +272,7 @@ class LoopDetection extends InterProcessData {
             if (!isset($se['end']) && $se['cc'] != ZPush::COMMAND_PING && !isset($se['push']) ) {
                 // there is no end time
                 ZLog::Write(LOGLEVEL_ERROR, sprintf("LoopDetection->ProcessLoopDetectionPreviousConnectionFailed(): Command '%s' at %s with pid '%d' terminated unexpectedly or is still running.", Utils::GetCommandFromCode($se['cc']), Utils::GetFormattedTime($se['time']), $se['pid']));
-                ZLog::Write(LOGLEVEL_ERROR, "Please check your logs for this PID and errors like PHP-Fatals or Apache segmentation faults and report your results to the Z-Push dev team.");
+                ZLog::Write(LOGLEVEL_ERROR, "Please check your logs for this PID and errors like PHP-Fatals or Apache segmentation faults and report your results to the D-Push dev team.");
             }
         }
     }
@@ -933,4 +933,4 @@ class LoopDetection extends InterProcessData {
     }
 }
 
-?>
\ No newline at end of file
+?>
diff --git a/lib/core/topcollector.php b/lib/core/topcollector.php
index ae1b247..f23960b 100644
--- a/lib/core/topcollector.php
+++ b/lib/core/topcollector.php
@@ -161,7 +161,7 @@ class TopCollector extends InterProcessData {
         // end exclusive block
 
         if ($this->isEnabled() === true && !$ok) {
-            ZLog::Write(LOGLEVEL_WARN, "TopCollector::AnnounceInformation(): could not write to shared memory. Z-Push top will not display this data.");
+            ZLog::Write(LOGLEVEL_WARN, "TopCollector::AnnounceInformation(): could not write to shared memory. D-Push top will not display this data.");
             return false;
         }
 
@@ -296,4 +296,4 @@ class TopCollector extends InterProcessData {
     }
 }
 
-?>
\ No newline at end of file
+?>
diff --git a/lib/core/zpush.php b/lib/core/zpush.php
index 2252c83..624cd5a 100644
--- a/lib/core/zpush.php
+++ b/lib/core/zpush.php
@@ -553,14 +553,18 @@ class ZPush {
         print <<<END
         <html>
         <header>
-        <title>Z-Push ActiveSync</title>
+        <title>d-push ActiveSync</title>
         </header>
         <body>
         <font face="verdana">
-        <h2>Z-Push - Open Source ActiveSync</h2>
+        <h2>d-push - Open Source ActiveSync</h2>
         <b>Version $zpush_version</b><br>
         $message $additionalMessage
         <br><br>
+	d-push is debians rebranding of z-push. The rebranding was done to avoid
+	possible trademark issues.<br>
+	Copyright (C) for z-push: Zarafa Deutschland GmbH <a href="http://www.zarafaserver.de/">http://www.zarafaserver.de/</a><br>
+
         More information about Z-Push can be found at:<br>
         <a href="http://z-push.sf.net/">Z-Push homepage</a><br>
         <a href="http://z-push.sf.net/download">Z-Push download page at BerliOS</a><br>
@@ -764,4 +768,4 @@ END;
     }
 
 }
-?>
\ No newline at end of file
+?>
diff --git a/lib/utils/timezoneutil.php b/lib/utils/timezoneutil.php
index 910b3fc..a5b7259 100644
--- a/lib/utils/timezoneutil.php
+++ b/lib/utils/timezoneutil.php
@@ -1195,7 +1195,7 @@ class TimezoneUtil {
         }
 
         if (!isset($tzname) || is_int($tzname)) {
-            ZLog::Write(LOGLEVEL_ERROR, sprintf("TimezoneUtil::guessTZNameFromPHPName() no compatible timezone found for '%s'. Returning 'GMT Standard Time'. Please contact the Z-Push dev team.", $phpname));
+            ZLog::Write(LOGLEVEL_ERROR, sprintf("TimezoneUtil::guessTZNameFromPHPName() no compatible timezone found for '%s'. Returning 'GMT Standard Time'. Please contact the D-Push dev team.", $phpname));
             return self::$mstzones["085"][0];
         }
 
@@ -1260,4 +1260,4 @@ class TimezoneUtil {
 
 }
 
-?>
\ No newline at end of file
+?>
diff --git a/lib/wbxml/wbxmldecoder.php b/lib/wbxml/wbxmldecoder.php
index ea8a703..3544534 100644
--- a/lib/wbxml/wbxmldecoder.php
+++ b/lib/wbxml/wbxmldecoder.php
@@ -171,7 +171,7 @@ class WBXMLDecoder extends WBXMLDefs {
             ZLog::Write(LOGLEVEL_WBXMLSTACK, sprintf("WBXMLDecoder->getElementEndTag(): unmatched WBXML tag: '%s' type '%s' flags '%s'", ((isset($element[EN_TAG]))?$element[EN_TAG]:""), ((isset($element[EN_TYPE]))?$element[EN_TYPE]:""), ((isset($element[EN_FLAGS]))?$element[EN_FLAGS]:"")));
 
             $bt = debug_backtrace();
-            ZLog::Write(LOGLEVEL_ERROR, sprintf("WBXMLDecoder->getElementEndTag(): could not read end tag in '%s'. Please enable the LOGLEVEL_WBXML and send the log to the Z-Push dev team.", $bt[0]["file"] . ":" . $bt[0]["line"]));
+            ZLog::Write(LOGLEVEL_ERROR, sprintf("WBXMLDecoder->getElementEndTag(): could not read end tag in '%s'. Please enable the LOGLEVEL_WBXML and send the log to the D-Push dev team.", $bt[0]["file"] . ":" . $bt[0]["line"]));
 
             // log the remaining wbxml content
             $this->ungetElement($element);
@@ -665,4 +665,4 @@ class WBXMLDecoder extends WBXMLDefs {
     }
 }
 
-?>
\ No newline at end of file
+?>
